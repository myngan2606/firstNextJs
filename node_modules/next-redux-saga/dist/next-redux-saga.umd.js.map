{"version":3,"file":"next-redux-saga.umd.js","sources":["../index.js"],"sourcesContent":["import React, {Component} from 'react'\nimport {END} from 'redux-saga'\n\nfunction hoc(config) {\n  return BaseComponent => {\n    class WrappedComponent extends Component {\n      static displayName = `withReduxSaga(${BaseComponent.displayName ||\n        BaseComponent.name ||\n        'BaseComponent'})`\n\n      static async getInitialProps(props) {\n        const {isServer, store} = props.ctx\n\n        let pageProps = {}\n        if (BaseComponent.getInitialProps) {\n          pageProps = await BaseComponent.getInitialProps(props)\n        }\n\n        // Keep saga running on the client (async mode)\n        if (config.async && !isServer) {\n          return pageProps\n        }\n\n        // Force saga to end in all other cases\n        store.dispatch(END)\n        await store.sagaTask.done\n\n        // Restart saga on the client (sync mode)\n        if (!isServer) {\n          store.runSagaTask()\n        }\n\n        return pageProps\n      }\n\n      render() {\n        return <BaseComponent {...this.props} />\n      }\n    }\n\n    return WrappedComponent\n  }\n}\n\nfunction withReduxSaga(arg) {\n  const defaultConfig = {async: false}\n\n  if (typeof arg === 'function') {\n    return hoc(defaultConfig)(arg)\n  }\n\n  return hoc({...defaultConfig, ...arg})\n}\n\nexport default withReduxSaga\n"],"names":["hoc","config","BaseComponent","WrappedComponent","React","props","ctx","isServer","store","pageProps","getInitialProps","async","dispatch","END","sagaTask","done","runSagaTask","Component","displayName","name","withReduxSaga","arg","defaultConfig"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAGA,SAASA,GAAT,CAAaC,MAAb,EAAqB;EACnB,SAAO,UAAAC,aAAa,EAAI;EAAA,QAChBC,gBADgB;EAAA;EAAA;EAAA;;EAAA;EAAA;;EAAA;EAAA;;EAAA;EAAA;EAAA,iCA+BX;EACP,iBAAOC,6BAAC,aAAD,EAAmB,KAAKC,KAAxB,CAAP;EACD;EAjCmB;EAAA;EAAA;EAAA;EAAA;EAAA,oDAMSA,KANT;EAAA;;EAAA;EAAA;EAAA;EAAA;EAAA,iCAOQA,KAAK,CAACC,GAPd,EAOXC,QAPW,cAOXA,QAPW,EAODC,KAPC,cAODA,KAPC;EASdC,oBAAAA,SATc,GASF,EATE;;EAAA,yBAUdP,aAAa,CAACQ,eAVA;EAAA;EAAA;EAAA;;EAAA;EAAA,2BAWER,aAAa,CAACQ,eAAd,CAA8BL,KAA9B,CAXF;;EAAA;EAWhBI,oBAAAA,SAXgB;;EAAA;EAAA,0BAedR,MAAM,CAACU,KAAP,IAAgB,CAACJ,QAfH;EAAA;EAAA;EAAA;;EAAA,qDAgBTE,SAhBS;;EAAA;EAmBlB;EACAD,oBAAAA,KAAK,CAACI,QAAN,CAAeC,aAAf;EApBkB;EAAA,2BAqBZL,KAAK,CAACM,QAAN,CAAeC,IArBH;;EAAA;EAuBlB;EACA,wBAAI,CAACR,QAAL,EAAe;EACbC,sBAAAA,KAAK,CAACQ,WAAN;EACD;;EA1BiB,qDA4BXP,SA5BW;;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA;;EAAA;EAAA;EAAA;EAAA;EAAA;;EAAA;EAAA,MACSQ,eADT;;EAAA,0BAChBd,gBADgB;EAAA;EAAA;EAAA;EAAA,qCAEkBD,aAAa,CAACgB,WAAd,IACpChB,aAAa,CAACiB,IADsB,IAEpC,eAJkB;EAAA;EAoCtB,WAAOhB,gBAAP;EACD,GArCD;EAsCD;;EAED,SAASiB,aAAT,CAAuBC,GAAvB,EAA4B;EAC1B,MAAMC,aAAa,GAAG;EAACX,IAAAA,KAAK,EAAE;EAAR,GAAtB;;EAEA,MAAI,OAAOU,GAAP,KAAe,UAAnB,EAA+B;EAC7B,WAAOrB,GAAG,CAACsB,aAAD,CAAH,CAAmBD,GAAnB,CAAP;EACD;;EAED,SAAOrB,GAAG,mBAAKsB,aAAL,EAAuBD,GAAvB,EAAV;EACD;;;;;;;;"}