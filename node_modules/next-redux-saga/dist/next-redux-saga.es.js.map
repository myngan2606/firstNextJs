{"version":3,"file":"next-redux-saga.es.js","sources":["../index.js"],"sourcesContent":["import React, {Component} from 'react'\nimport {END} from 'redux-saga'\n\nfunction hoc(config) {\n  return BaseComponent => {\n    class WrappedComponent extends Component {\n      static displayName = `withReduxSaga(${BaseComponent.displayName ||\n        BaseComponent.name ||\n        'BaseComponent'})`\n\n      static async getInitialProps(props) {\n        const {isServer, store} = props.ctx\n\n        let pageProps = {}\n        if (BaseComponent.getInitialProps) {\n          pageProps = await BaseComponent.getInitialProps(props)\n        }\n\n        // Keep saga running on the client (async mode)\n        if (config.async && !isServer) {\n          return pageProps\n        }\n\n        // Force saga to end in all other cases\n        store.dispatch(END)\n        await store.sagaTask.done\n\n        // Restart saga on the client (sync mode)\n        if (!isServer) {\n          store.runSagaTask()\n        }\n\n        return pageProps\n      }\n\n      render() {\n        return <BaseComponent {...this.props} />\n      }\n    }\n\n    return WrappedComponent\n  }\n}\n\nfunction withReduxSaga(arg) {\n  const defaultConfig = {async: false}\n\n  if (typeof arg === 'function') {\n    return hoc(defaultConfig)(arg)\n  }\n\n  return hoc({...defaultConfig, ...arg})\n}\n\nexport default withReduxSaga\n"],"names":["hoc","config","BaseComponent","WrappedComponent","props","ctx","isServer","store","pageProps","getInitialProps","async","dispatch","END","sagaTask","done","runSagaTask","Component","displayName","name","withReduxSaga","arg","defaultConfig"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,SAASA,GAAT,CAAaC,MAAb,EAAqB;SACZ,UAAAC,aAAa,EAAI;QAChBC,gBADgB;;;;;;;;;;;;;iCA+BX;iBACA,oBAAC,aAAD,EAAmB,KAAKC,KAAxB,CAAP;;;;;;;oDA1B2BA,KANT;;;;;;;iCAOQA,KAAK,CAACC,GAPd,EAOXC,QAPW,cAOXA,QAPW,EAODC,KAPC,cAODA,KAPC;oBASdC,SATc,GASF,EATE;;yBAUdN,aAAa,CAACO,eAVA;;;;;;2BAWEP,aAAa,CAACO,eAAd,CAA8BL,KAA9B,CAXF;;;oBAWhBI,SAXgB;;;0BAedP,MAAM,CAACS,KAAP,IAAgB,CAACJ,QAfH;;;;;qDAgBTE,SAhBS;;;;oBAoBlBD,KAAK,CAACI,QAAN,CAAeC,GAAf;;2BACML,KAAK,CAACM,QAAN,CAAeC,IArBH;;;;wBAwBd,CAACR,QAAL,EAAe;sBACbC,KAAK,CAACQ,WAAN;;;qDAGKP,SA5BW;;;;;;;;;;;;;;;;;MACSQ,SADT;;0BAChBb,gBADgB;;;;qCAEkBD,aAAa,CAACe,WAAd,IACpCf,aAAa,CAACgB,IADsB,IAEpC,eAJkB;;WAoCff,gBAAP;GApCF;;;AAwCF,SAASgB,aAAT,CAAuBC,GAAvB,EAA4B;MACpBC,aAAa,GAAG;IAACX,KAAK,EAAE;GAA9B;;MAEI,OAAOU,GAAP,KAAe,UAAnB,EAA+B;WACtBpB,GAAG,CAACqB,aAAD,CAAH,CAAmBD,GAAnB,CAAP;;;SAGKpB,GAAG,mBAAKqB,aAAL,EAAuBD,GAAvB,EAAV;;;;;"}